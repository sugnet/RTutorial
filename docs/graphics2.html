<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 R graphics: Round II | Introduction into R Applications and Programming: A Tutorial</title>
<meta name="author" content="Niël J le Roux and Sugnet Lubbe">
<meta name="description" content="R offers several different types of graphics: grid graphics is contained in package grid; the package lattice contains trellis graphics; the package ggplot2 introduces ggplot graphics to be...">
<meta name="generator" content="bookdown 0.44 with bs4_book()">
<meta property="og:title" content="Chapter 11 R graphics: Round II | Introduction into R Applications and Programming: A Tutorial">
<meta property="og:type" content="book">
<meta property="og:url" content="https://github.com/sugnet/RTutorial/graphics2.html">
<meta property="og:image" content="https://github.com/sugnet/RTutorial/frontcover.jpg">
<meta property="og:description" content="R offers several different types of graphics: grid graphics is contained in package grid; the package lattice contains trellis graphics; the package ggplot2 introduces ggplot graphics to be...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 R graphics: Round II | Introduction into R Applications and Programming: A Tutorial">
<meta name="twitter:description" content="R offers several different types of graphics: grid graphics is contained in package grid; the package lattice contains trellis graphics; the package ggplot2 introduces ggplot graphics to be...">
<meta name="twitter:image" content="https://github.com/sugnet/RTutorial/frontcover.jpg">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.9.0/transition.js"></script><script src="libs/bs3compat-0.9.0/tabs.js"></script><script src="libs/bs3compat-0.9.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
          margin-bottom: 1em;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction into R Applications and Programming: A Tutorial</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled"><li><a class="" href="index.html"><span class="header-section-number">Chapter 11</span> R graphics: Round II</a></li></ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/sugnet/RTutorial">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="graphics2" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> R graphics: Round II<a class="anchor" aria-label="anchor" href="#graphics2"><i class="fas fa-link"></i></a>
</h1>
<p>R offers several different types of graphics: <em><span style="color:#FF9966">grid</span></em> graphics is contained in package <code>grid</code>; the package <code>lattice</code> contains <em><span style="color:#FF9966">trellis</span></em> graphics; the package <code>ggplot2</code> introduces <em><span style="color:#FF9966">ggplot</span></em> graphics to be implemented by the function <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. In this chapter, further aspects of what is known as <em>traditional R graphics</em> are studied before moving on to ggplot graphics.</p>
<div id="graphics-parameters" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Graphics parameters<a class="anchor" aria-label="anchor" href="#graphics-parameters"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Study the help file of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. Execute <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> to obtain a list of all the current values of the graphical parameters.</p></li>
<li><p>How is <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> used to obtain the current setting of a specific graphics parameter e.g. the parameter <code>fin</code>?</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">"fin"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6.999999 4.999999</span></span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>How is <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> used to change a graphics parameter e.g. <code>mfrow</code>?</p></li>
<li><p>How do you reset the changed values to their original values? Note the <code>no.readonly</code> argument of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>. <em>Hint</em>: Study the following instructions and there effects carefully:</p></li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">'col'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "black"</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>The current colour for graphics is “black”.</p>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>Change colour for graphics to “blue”.</p>
</div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">temp</span></span>
<span><span class="co">#&gt; $col</span></span>
<span><span class="co">#&gt; [1] "black"</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>Temp is a list of parameter(s) <strong>BEFORE</strong> change was made.</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span><span class="st">'col'</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "black"</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>Shows that the colour for graphics was indeed changed to “blue”.</p>
</div>
<ol start="5" style="list-style-type: lower-alpha">
<li><p>It is sometimes useful to use <code>par (ask = TRUE)</code> to instruct R to ask you whether an existing graph should be replaced by a new one.</p></li>
<li><p>Draw a histogram of variable Ozone in the data set <code>airquality</code> where each class interval is randomly represented by a different colour. What happened to the <code>NA</code> values?</p></li>
</ol>
</div>
<div id="layout-of-graphics" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Layout of graphics<a class="anchor" aria-label="anchor" href="#layout-of-graphics"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li><p>Review Figure <a href="#fig:figRegion"><strong>??</strong></a>. Note the parameters that are discussed there.</p></li>
<li><p>Multiple figures on one page: How do the graphical parameters <code>mfg</code> and <code>mfrow</code> or <code>mfcol</code> differ? What are represented in the R data sets <code>ldeaths</code>, <code>mdeaths</code> and <code>fdeaths</code>? Use <code>mfg</code> and <code>mfrow</code> to obtain Figure <a href="graphics2.html#fig:fmdeaths">11.1</a>. <em>Hint</em>: The graphics parameters <code>mfg</code> and <code>mfrow</code> are used together.</p></li>
</ol>
<div class="figure">
<span style="display:block;" id="fig:fmdeaths"></span>
<img src="10-graphics2_files/figure-html/fmdeaths-1.png" alt="Plots of the fdeaths and mdeaths data sets" width="100%"><p class="caption">
Figure 11.1: Plots of the fdeaths and mdeaths data sets
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, mfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>The <code>mfrow</code> setting reserves three rows and two columns for graphics to be filled row-wise. The <code>mfg</code> setting specifies that the next graph will be placed in the position defined by row one column one. Once this graph has been constructed the instruction</p>
</div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>mfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>will result in the next graph to appear in the position defined by row one and column two. Next we need the instruction</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span>, mfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>requesting a graph window having three rows and one column with the next graph to appear at position row two (only one column in row two).</p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>Note how the meaning of the margins changes when more than one figure is drawn on a page to make provision for an <em><span style="color:#FF9966">outer margin</span></em> surrounding all figures in addition to the <em><span style="color:#FF9966">margin</span></em> surrounding each separate figure.</p></li>
<li><p>Study how the functions <code><a href="https://rdrr.io/r/graphics/screen.html">split.screen()</a></code>, <code><a href="https://rdrr.io/r/graphics/screen.html">screen()</a></code> and <code><a href="https://rdrr.io/r/graphics/screen.html">close.screen()</a></code> work as explained in the help facility.</p></li>
<li><p>Study the usage of the function <code><a href="https://rdrr.io/r/graphics/layout.html">layout()</a></code> in detail for more complicated arrangements of the graph window. An example of its usage is deferred until later in the chapter.</p></li>
</ol>
</div>
<div id="low-level-plotting-commands" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Low-level plotting commands<a class="anchor" aria-label="anchor" href="#low-level-plotting-commands"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>The functions in Table <a href="graphics2.html#tab:lowlevelPlotFuncs">11.1</a> are used to edit existing graphs.<br>
</li>
<li>Study these functions carefully.</li>
<li>Study how the right mouse button is used with R graphs.</li>
<li>Most plotting tasks require some combination of high-level and low-level plotting commands.</li>
</ul>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:lowlevelPlotFuncs">Table 11.1: </span> Low-level plotting functions.</caption>
<colgroup>
<col width="28%">
<col width="71%">
</colgroup>
<thead><tr class="header">
<th><em><span style="color:#CC99FF">Function</span></em></th>
<th><em><span style="color:#CC99FF">Description</span></em></th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/abline.html">abline()</a></code></td>
<td>Add regression lines to a plot; Also for adding a vertical and horizontal lines to a plot</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/arrows.html">arrows()</a></code></td>
<td>Draw arrow on plot</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/axis.html">axis()</a></code></td>
<td>Add custom axis to plot</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/box.html">box()</a></code></td>
<td>Draw box around plot</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/grDevices/chull.html">chull()</a></code></td>
<td>Compute a convex hull</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/base/jitter.html">jitter()</a></code></td>
<td>Add a small amount of noise</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code></td>
<td>Add a legend to a plot</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code></td>
<td>Add lines to a plot</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/mtext.html">mtext()</a></code></td>
<td>Write text in margins</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code></td>
<td>Add points to a plot</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/polygon.html">polygon()</a></code></td>
<td>Draw and shade polygons</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/rug.html">rug()</a></code></td>
<td>Add data-based marks to an axis</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/segments.html">segments()</a></code></td>
<td>Draw disconnected line segments</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/symbols.html">symbols()</a></code></td>
<td>Draw symbols on a plot</td>
</tr>
<tr class="odd">
<td><code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code></td>
<td>Add text to a plot</td>
</tr>
<tr class="even">
<td><code><a href="https://rdrr.io/r/graphics/title.html">title()</a></code></td>
<td>Add titles or axis labels to a plot</td>
</tr>
</tbody>
</table></div>
</div>
<div id="using-the-plotting-commands" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> Using the plotting commands<a class="anchor" aria-label="anchor" href="#using-the-plotting-commands"><i class="fas fa-link"></i></a>
</h2>
<div id="matplot" class="section level3" number="11.4.1">
<h3>
<span class="header-section-number">11.4.1</span> Multiple lines or groups of points on the same graph<a class="anchor" aria-label="anchor" href="#matplot"><i class="fas fa-link"></i></a>
</h3>
<p>Study how the function <code><a href="https://rdrr.io/r/graphics/matplot.html">matplot()</a></code> works. Note the functions <code><a href="https://rdrr.io/r/graphics/matplot.html">matlines()</a></code> and <code><a href="https://rdrr.io/r/graphics/matplot.html">matpoints()</a></code>. Study and execute the following example:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">{</span> <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span></span>
<span>    <span class="op">{</span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">*</span> <span class="fl">10000</span></span>
<span>       <span class="va">s1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span></span>
<span>       <span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>       <span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span>       <span class="va">times</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>       <span class="va">times</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>       <span class="va">times</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">s3</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>     <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html">matplot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">*</span><span class="fl">10000</span>, y<span class="op">=</span> <span class="va">times</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>          col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Length"</span>,  </span>
<span>          ylab <span class="op">=</span> <span class="st">"Time in seconds"</span>, main <span class="op">=</span> <span class="st">"Time for sorting"</span><span class="op">)</span>  </span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:matplotExample"></span>
<img src="10-graphics2_files/figure-html/matplotExample-1.png" alt="Three methods of performing sort." width="100%"><p class="caption">
Figure 11.2: Three methods of performing sort.
</p>
</div>
</div>
<div id="multipleLines" class="section level3" number="11.4.2">
<h3>
<span class="header-section-number">11.4.2</span> Multiple lines or groups of points on the same graph but the lines (points) are not all the same length (number)<a class="anchor" aria-label="anchor" href="#multipleLines"><i class="fas fa-link"></i></a>
</h3>
<p>What technique must be followed? First study the <code>Cars93</code> data set in package <code>MASS</code>; then study and execute the code below. Experiment with different values of <code>spar</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">spar</span> <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>                             <span class="co"># What is the effect of require()?</span></span>
<span>  <span class="va">oldstate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>       <span class="co"># Describe object 'oldstate'</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span><span class="va">oldstate</span><span class="op">)</span><span class="op">)</span>                   <span class="co"># Of what use is on.exit()?</span></span>
<span></span>
<span>  <span class="va">cargrp</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"Type"</span><span class="op">]</span></span>
<span>  <span class="va">price</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"Price"</span><span class="op">]</span></span>
<span>  <span class="va">mpg.city</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"MPG.city"</span><span class="op">]</span></span>
<span>  <span class="va">mpg.highway</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"MPG.highway"</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">price</span>, <span class="va">mpg.city</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mpg.city</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"Fuel Consumption vs Price for City Drive"</span>, xlab <span class="op">=</span> <span class="st">"Price"</span>, </span>
<span>       ylab <span class="op">=</span> <span class="st">"Miles per Gallon in City"</span><span class="op">)</span></span>
<span>  <span class="va">jj</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cargrp</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">{</span>  <span class="va">jj</span> <span class="op">&lt;-</span> <span class="va">jj</span><span class="op">+</span><span class="fl">1</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline</a></span> <span class="op">(</span><span class="va">price</span><span class="op">[</span><span class="va">cargrp</span><span class="op">==</span><span class="va">i</span><span class="op">]</span>, <span class="va">mpg.city</span><span class="op">[</span><span class="va">cargrp</span><span class="op">==</span><span class="va">i</span><span class="op">]</span>, spar<span class="op">=</span><span class="va">spar</span><span class="op">)</span>,</span>
<span>              lty <span class="op">=</span> <span class="va">jj</span>, col <span class="op">=</span> <span class="va">jj</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">price</span>, <span class="va">mpg.highway</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mpg.highway</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"Fuel Consumption vs Price for Highway Drive"</span>, xlab <span class="op">=</span> <span class="st">"Price"</span>, </span>
<span>       ylab <span class="op">=</span> <span class="st">"Miles per Gallon on Highway"</span><span class="op">)</span></span>
<span>  <span class="va">jj</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cargrp</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">{</span>  <span class="va">jj</span> <span class="op">&lt;-</span> <span class="va">jj</span><span class="op">+</span><span class="fl">1</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline</a></span> <span class="op">(</span><span class="va">price</span><span class="op">[</span><span class="va">cargrp</span><span class="op">==</span><span class="va">i</span><span class="op">]</span>, <span class="va">mpg.highway</span><span class="op">[</span><span class="va">cargrp</span><span class="op">==</span><span class="va">i</span><span class="op">]</span>, </span>
<span>                             spar <span class="op">=</span> <span class="va">spar</span><span class="op">)</span>,</span>
<span>              lty <span class="op">=</span> <span class="va">jj</span>, col <span class="op">=</span> <span class="va">jj</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span> <span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:diffLengths-1"></span>
<img src="10-graphics2_files/figure-html/diffLengths-1.png" alt="Plotting multiple lines of different lenghts" width="100%"><p class="caption">
Figure 11.3: Plotting multiple lines of different lenghts
</p>
</div>
<div class="figure">
<span style="display:block;" id="fig:diffLengths-2"></span>
<img src="10-graphics2_files/figure-html/diffLengths-2.png" alt="Plotting multiple lines of different lenghts" width="100%"><p class="caption">
Figure 11.4: Plotting multiple lines of different lenghts
</p>
</div>
<ol style="list-style-type: lower-alpha">
<li><p>Explain the output generated by the above function call.</p></li>
<li><p>What technique can also be followed in the case of point diagrams?</p></li>
</ol>
</div>
<div id="Legends" class="section level3" number="11.4.3">
<h3>
<span class="header-section-number">11.4.3</span> Adding legends to a graph<a class="anchor" aria-label="anchor" href="#Legends"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Study how the function <code><a href="https://rdrr.io/r/graphics/legend.html">legend()</a></code> and the graphical parameter <code>usr</code> work. Study the code used to obtain Figure <a href="graphics2.html#fig:cargrps">11.5</a>. Revise the <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> function.</p></li>
<li><p>Use the facts that one USA gallon of liquid is equal to <span class="math inline">\(0.83267\)</span> UK (imperial) gallon of liquid and one mile is equal to <span class="math inline">\(1.6093\)</span> kilometres to obtain a figure similar to Figure 10.4.1 but with a kilometres per litre scale on the right-hand side that corresponds to the miles per gallon (USA) on highway scale on the left-hand side.</p></li>
</ol>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">{</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span>  </span>
<span>  <span class="va">oldstate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span><span class="va">oldstate</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>  <span class="va">cargrp</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"Type"</span><span class="op">]</span></span>
<span>  <span class="va">price</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"Price"</span><span class="op">]</span></span>
<span>  <span class="va">mpg.city</span> <span class="op">&lt;-</span> <span class="va">Cars93</span><span class="op">[</span> , <span class="st">"MPG.city"</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">price</span>, <span class="va">mpg.city</span>, type <span class="op">=</span> <span class="st">"n"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">mpg.city</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"Fuel Consumption vs Price for City Drive"</span>, xlab <span class="op">=</span> <span class="st">"Price"</span>, </span>
<span>       ylab <span class="op">=</span> <span class="st">"Miles per Gallon in City"</span><span class="op">)</span></span>
<span>  <span class="va">char</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span> <span class="op">(</span><span class="va">cargrp</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span> <span class="op">(</span>x <span class="op">=</span> <span class="va">price</span>, y <span class="op">=</span> <span class="va">mpg.city</span>, labels <span class="op">=</span> <span class="va">char</span>, pos <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span></span>
<span>  <span class="va">labs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substr.html">substring</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span> <span class="op">(</span><span class="va">cargrp</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">cargrp</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">":  "</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">40</span>, y <span class="op">=</span> <span class="fl">42</span>, legend <span class="op">=</span> <span class="va">labs</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span> <span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:cargrps"></span>
<img src="10-graphics2_files/figure-html/cargrps-1.png" alt="Illustrating adding a legend to a plot." width="100%"><p class="caption">
Figure 11.5: Illustrating adding a legend to a plot.
</p>
</div>
</div>
<div id="multAxes" class="section level3" number="11.4.4">
<h3>
<span class="header-section-number">11.4.4</span> Multiple plots with identical axes<a class="anchor" aria-label="anchor" href="#multAxes"><i class="fas fa-link"></i></a>
</h3>
<p>How can various graphs with identical axes be obtained? Show how this can be done by graphing the sorting time for the three procedures considered in <a href="graphics2.html#matplot">11.4.1</a> above in three separate plots in the same graph window.</p>
</div>
<div id="providing-a-single-legend-for-multiple-plots" class="section level3" number="11.4.5">
<h3>
<span class="header-section-number">11.4.5</span> Providing a single legend for multiple plots<a class="anchor" aria-label="anchor" href="#providing-a-single-legend-for-multiple-plots"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose there were two sorting methods for each of the three situations described in<a href="graphics2.html#matplot">11.4.1</a> and <a href="graphics2.html#multAxes">11.4.4</a> above. How can the three graphs be provided with a single legend without the legend appearing in one of the graphs? Explain in detail.</p>
</div>
<div id="changing-the-plotting-character-common-plotting-characters-in-r" class="section level3" number="11.4.6">
<h3>
<span class="header-section-number">11.4.6</span> Changing the plotting character: common plotting characters in R<a class="anchor" aria-label="anchor" href="#changing-the-plotting-character-common-plotting-characters-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>Note the use of graphical parameters <code>pch</code> and <code>mkh</code>. What plotting characters are available? Study the help file of <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code> and <code><a href="https://rdrr.io/r/graphics/points.html">points()</a></code>. Study the plotting characters displayed in Figure <a href="graphics2.html#fig:pch">11.6</a> and the code used to produce the figure. How can plotting characters be made to appear in legends?</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span> <span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">19</span>, cex <span class="op">=</span> <span class="fl">2</span>, </span>
<span>      pty <span class="op">=</span> <span class="st">"p"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">3</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:pch"></span>
<img src="10-graphics2_files/figure-html/pch-1.png" alt="Some common plotting characters available in R." width="100%"><p class="caption">
Figure 11.6: Some common plotting characters available in R.
</p>
</div>
</div>
<div id="changing-the-colour-in-plots" class="section level3" number="11.4.7">
<h3>
<span class="header-section-number">11.4.7</span> Changing the colour in plots<a class="anchor" aria-label="anchor" href="#changing-the-colour-in-plots"><i class="fas fa-link"></i></a>
</h3>
<p>The graphical parameter <code>col</code> allows the user to specify the colour(s) in number format as given in Figure <a href="graphics2.html#fig:col">11.8</a>. The full list of named colours can be obtained with the command <code><a href="https://rdrr.io/r/grDevices/colors.html">colors()</a></code> in the Console.</p>
<p>Alternatively, the colour can be specified by hue, saturation and value with <code>hsv (h = , s = , v = )</code>, hue, chroma and luminance with <code>hcl (h = , c = , l = )</code> or red, green and blue with <code>rgb (red = , green = , blue = )</code>. The <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> function has an argument <code>maxColorValue</code> with default value <code>1</code> which indicates the range known as the gamma-compressed values. Typically, the red, green and blue values range between 0 and 255 or video display or 8-bit graphics. To select a specific shade of light blue, the following command can be used:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span> <span class="op">(</span><span class="va">ldeaths</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html">rgb</a></span> <span class="op">(</span>red <span class="op">=</span> <span class="fl">167</span>, green <span class="op">=</span> <span class="fl">227</span>, blue <span class="op">=</span> <span class="fl">227</span>, </span>
<span>                          maxColorValue <span class="op">=</span> <span class="fl">255</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:colExample"></span>
<img src="10-graphics2_files/figure-html/colExample-1.png" alt="Colour selection with rgb()." width="100%"><p class="caption">
Figure 11.7: Colour selection with rgb().
</p>
</div>
<p>The output of the <code><a href="https://rdrr.io/r/grDevices/rgb.html">rgb()</a></code> function is in the hexidemical colour number format, e.g. “#A7E3E3”. The function <code><a href="https://rdrr.io/r/grDevices/col2rgb.html">col2rgb()</a></code> accepts a colour name, hexadecimal colour number format or colour number and provides the red, green and blue values in the 0 to 255 range.</p>
<div class="figure">
<span style="display:block;" id="fig:col"></span>
<img src="10-graphics2_files/figure-html/col-1.png" alt="The default colour palette available in R." width="100%"><p class="caption">
Figure 11.8: The default colour palette available in R.
</p>
</div>
<p>A sequence of <span class="math inline">\(n\)</span> colours can be generated with the function <code><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette()</a></code>. As an example, the colour vector used for plotting in Figure <a href="graphics2.html#fig:colRamp">11.9</a> were generated with the call <code>colorRampPalette (c ("red", "green", "white", "gold"))(20)</code>. Study how the following instructions generate colour sequences: <code><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">heat.colors()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">terrain.colors()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">topo.colors()</a></code>, <code><a href="https://rdrr.io/r/grDevices/palettes.html">cm.colors()</a></code>.</p>
<div class="figure">
<span style="display:block;" id="fig:colRamp"></span>
<img src="10-graphics2_files/figure-html/colRamp-1.png" alt="User specified colour sequence with colorRampPalette()." width="100%"><p class="caption">
Figure 11.9: User specified colour sequence with colorRampPalette().
</p>
</div>
</div>
<div id="logarithmic-axes" class="section level3" number="11.4.8">
<h3>
<span class="header-section-number">11.4.8</span> Logarithmic axes<a class="anchor" aria-label="anchor" href="#logarithmic-axes"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code> function and the <code>log</code> argument of the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function are useful in this regard. The <code>log</code> argument of the <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> function can be specified as <code>log="x"</code>; or <code>log="y"</code>; or <code>log="xy"</code> depending on whether the x-axis, the y-axis, or both axes should be plotted logarithmically.</p>
</div>
<div id="graphs-with-character-strings-as-the-scale-on-the-axis" class="section level3" number="11.4.9">
<h3>
<span class="header-section-number">11.4.9</span> Graphs with character strings as the ‘scale’ on the axis<a class="anchor" aria-label="anchor" href="#graphs-with-character-strings-as-the-scale-on-the-axis"><i class="fas fa-link"></i></a>
</h3>
<p>Figure <a href="graphics2.html#fig:catAxis">11.10</a> illustrates how user defined character strings can appear as calibrations on an axis. Furthermore, this figure illustrates several techniques to fine-tune plots. Study the code resulting in Figure <a href="graphics2.html#fig:catAxis">11.10</a> in detail.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">{</span> <span class="va">old.state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span><span class="va">old.state</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">area</span> <span class="op">&lt;-</span> <span class="va">state.x77</span><span class="op">[</span>, <span class="st">"Area"</span><span class="op">]</span></span>
<span>  <span class="va">income</span> <span class="op">&lt;-</span> <span class="va">state.x77</span><span class="op">[</span>, <span class="st">"Income"</span><span class="op">]</span></span>
<span>  <span class="va">area.grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">area</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span> <span class="op">(</span><span class="va">area</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Small"</span>, <span class="st">"Medium"</span>, <span class="st">"Large"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">income.grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">income</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span> <span class="op">(</span><span class="va">income</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Below Median"</span>, <span class="st">"Above Median"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">mns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tapply.html">tapply</a></span><span class="op">(</span><span class="va">state.x77</span><span class="op">[</span>, <span class="st">"Illiteracy"</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">area.grp</span>, <span class="va">income.grp</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">mns</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">"Area Group"</span>, </span>
<span>       ylab <span class="op">=</span><span class="st">"Mean Illiteracy"</span>, sub <span class="op">=</span> <span class="st">"Function plot() used"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op">(</span>side <span class="op">=</span> <span class="fl">1</span>, at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">area.grp</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">mns</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="va">mns</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>usr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="fl">0.56</span>, <span class="fl">0.96</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">income.grp</span><span class="op">)</span>, cex<span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">0.63</span>, <span class="fl">0.98</span>, adj <span class="op">=</span> <span class="fl">0</span>, <span class="st">"Income Group"</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/interaction.plot.html">interaction.plot</a></span><span class="op">(</span><span class="va">area.grp</span>, <span class="va">income.grp</span>, <span class="va">state.x77</span><span class="op">[</span>,<span class="st">"Illiteracy"</span><span class="op">]</span>, </span>
<span>                     xlab <span class="op">=</span> <span class="st">"Area Group"</span>, ylab <span class="op">=</span> <span class="st">"Mean Illiteracy"</span>, </span>
<span>                     sub <span class="op">=</span> <span class="st">"Interaction.plot used"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, xtick <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                     legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>new <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, type<span class="op">=</span><span class="st">"n"</span>, xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>,axes <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">"Illiteracy vs Size for States grouped by Income"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span> <span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:catAxis"></span>
<img src="10-graphics2_files/figure-html/catAxis-1.png" alt="Figures with character strings as axis calibrations and other enhancements to plots." width="100%"><p class="caption">
Figure 11.10: Figures with character strings as axis calibrations and other enhancements to plots.
</p>
</div>
</div>
<div id="customizing-bar-charts-and-histograms" class="section level3" number="11.4.10">
<h3>
<span class="header-section-number">11.4.10</span> Customizing bar charts and histograms<a class="anchor" aria-label="anchor" href="#customizing-bar-charts-and-histograms"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li><p>How can every bar in a bar chart be represented in a different colour and be given separate headings?</p></li>
<li><p>How can only a line graph without any colours be obtained?</p></li>
<li><p>How can a probability density function be superimposed on a histogram?</p></li>
<li><p>How can bar charts be provided with user-defined axes?</p></li>
</ol>
<p>Use the <code>Cars93</code> data set to answer the above four questions by constructing a figure similar to the one shown in Figure <a href="graphics2.html#fig:BarHist">11.11</a>. Note: In the Mean MPG plot not all car types are used. If a factor variable is subsetted the original levels will be kept although some of them might not occurr. Hence it might be necessary to create a new factor variable with only the levels that are needed by using <code><a href="https://rdrr.io/r/base/factor.html">factor()</a></code>.</p>
<div class="figure">
<span style="display:block;" id="fig:BarHist"></span>
<img src="10-graphics2_files/figure-html/BarHist-1.png" alt="Enhanced bar charts and histograms." width="100%"><p class="caption">
Figure 11.11: Enhanced bar charts and histograms.
</p>
</div>
</div>
<div id="three-dimensional-graphical-displays" class="section level3" number="11.4.11">
<h3>
<span class="header-section-number">11.4.11</span> Three-dimensional graphical displays<a class="anchor" aria-label="anchor" href="#three-dimensional-graphical-displays"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Study how the function <code><a href="https://rdrr.io/r/graphics/persp.html">persp()</a></code> works.</p></li>
<li><p>Work through the example code that creates Figure <a href="graphics2.html#fig:persp">11.12</a>. Apart from the arrow that points to the maximum, different colours must be used to highlight the different aspects of the graph.</p></li>
<li><p>Provide horizontally and vertically rotated views of the 3D plot.</p></li>
</ol>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">{</span> <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span>, length<span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>  <span class="va">ff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span> <span class="op">{</span> <span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">+</span><span class="va">y</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>; <span class="fl">10</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">/</span><span class="va">r</span> <span class="op">}</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">ff</span><span class="op">)</span></span>
<span>  <span class="va">z</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span><span class="co">#  persp(x, y, z, theta = 30, phi = 30, expand = 0.5, col = "lightblue")</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/persp.html">persp</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span>, theta <span class="op">=</span> <span class="fl">30</span>, phi <span class="op">=</span> <span class="fl">30</span>, expand <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, </span>
<span>               ltheta <span class="op">=</span> <span class="fl">120</span>, shade <span class="op">=</span> <span class="fl">0.75</span>, ticktype <span class="op">=</span> <span class="st">"detailed"</span>, xlab <span class="op">=</span> <span class="st">"X"</span>, </span>
<span>               ylab <span class="op">=</span> <span class="st">"Y"</span>, zlab <span class="op">=</span> <span class="st">"Z"</span> <span class="op">)</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">res</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">#--- Add to existing persp plot : ---</span></span>
<span>  <span class="co">#--- Function trans3d() -------------</span></span>
<span>    <span class="va">trans3d</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>, <span class="va">pmat</span><span class="op">)</span> </span>
<span>    <span class="op">{</span></span>
<span>      <span class="va">tr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>,<span class="va">z</span>,<span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">pmat</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">tr</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">/</span><span class="va">tr</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">tr</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="va">tr</span><span class="op">[</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># ----------------------------------</span></span>
<span>  <span class="va">z1</span> <span class="op">&lt;-</span> <span class="fu">ff</span><span class="op">(</span><span class="fl">1e-10</span>, <span class="fl">1e-10</span><span class="op">)</span></span>
<span>  <span class="va">transfrm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/trans3d.html">trans3d</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">2.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">z1</span>,<span class="va">z1</span><span class="op">)</span>, <span class="va">res</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="va">transfrm</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">transfrm</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">transfrm</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">transfrm</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, </span>
<span>         length <span class="op">=</span> <span class="fl">0.1</span>, code <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="va">transfrm</span><span class="op">$</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">transfrm</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fl">0.02</span>, <span class="st">"Maximum occurs here"</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">z1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:persp"></span>
<img src="10-graphics2_files/figure-html/persp-1.png" alt="Annotated 3D perspective plot." width="100%"><p class="caption">
Figure 11.12: Annotated 3D perspective plot.
</p>
</div>
<pre><code>#&gt;       [,1]   [,2]   [,3]   [,4]
#&gt; [1,] 0.087 -0.025  0.043 -0.043
#&gt; [2,] 0.050  0.043 -0.075  0.075
#&gt; [3,] 0.000  0.074  0.042 -0.042
#&gt; [4,] 0.000 -0.273 -2.890  3.890
#&gt; [1] 10</code></pre>
</div>
<div id="diagrams" class="section level3" number="11.4.12">
<h3>
<span class="header-section-number">11.4.12</span> Diagrams<a class="anchor" aria-label="anchor" href="#diagrams"><i class="fas fa-link"></i></a>
</h3>
<p>Use R to draw a simple flow diagram. The diagram must contain at least one rectangle, one square, one circle and one triangle. Furthermore, there must be straight and curved lines as well as text describing the different elements. <em>Hint</em>: Study how the functions <code><a href="https://rdrr.io/r/graphics/arrows.html">arrows()</a></code>, <code><a href="https://rdrr.io/r/graphics/lines.html">lines()</a></code>, <code><a href="https://rdrr.io/r/graphics/text.html">text()</a></code> and <code><a href="https://rdrr.io/r/graphics/symbols.html">symbols()</a></code> work as discussed in their respective help facilities.</p>
</div>
<div id="annotating-graphics-with-special-symbols" class="section level3" number="11.4.13">
<h3>
<span class="header-section-number">11.4.13</span> Annotating graphics with special symbols<a class="anchor" aria-label="anchor" href="#annotating-graphics-with-special-symbols"><i class="fas fa-link"></i></a>
</h3>
<p>Construct a graph of a <span class="math inline">\(normal(0, 1)\)</span> density function. Give as a title to the plot the expression “Density of a normal random variable with <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma^2 = 1\)</span>.” <em>Hint</em>: Consult the help file of <code>plotmath()</code>. Within the plot draw an arrow to the density and label it <span class="math inline">\(\frac{1}{\sqrt{2 \pi}} e^{-\frac{1}{2}x^2}\)</span>.</p>
</div>
</div>
<div id="quantile-plots" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> Quantile plots<a class="anchor" aria-label="anchor" href="#quantile-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the histogram of weight in Figure <a href="graphics2.html#fig:BarHist">11.11</a>. Does this variable follow a normal distribution? A normal quantile plot, shows the observations vs the corresponding quantiles of a standard normal distribution. If the observations correspond to a normal distribution, this will approximately form a straight line. Use the <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqline()</a></code> function to add a straing line to the plot.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqnorm</a></span> <span class="op">(</span><span class="va">Cars93</span><span class="op">$</span><span class="va">Weight</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span> <span class="op">(</span><span class="va">Cars93</span><span class="op">$</span><span class="va">Weight</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/qq_norm-1.png" width="672"></div>
<p>In a similar manner, quantile-quantile plots for other probability distributions can be constructed with the function <code><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">rexp</a></span><span class="op">(</span><span class="fl">200</span>, rate<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqplot</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span> <span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">1</span>, len <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>, rate<span class="op">=</span><span class="fl">4</span><span class="op">)</span>, <span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html">qqline</a></span><span class="op">(</span><span class="va">y</span>, distribution <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">qexp</a></span><span class="op">(</span><span class="va">p</span>, rate<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/qq_other-1.png" width="672"></div>
</div>
<div id="density" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> Estimating a density<a class="anchor" aria-label="anchor" href="#density"><i class="fas fa-link"></i></a>
</h2>
<p>The histograms in Figure <a href="graphics2.html#fig:histDiffBins">11.13</a> show 200 observations generated, 100 from a <span class="math inline">\(normal (9,2^2)\)</span> and 100 from a <span class="math inline">\(normal (13,1)\)</span> distribution. Histograms are very sensitive to the choice of the number of bins and the starting values of the bins. The wider bins do not show any evidence of a bimodal distribution. Using the smaller bins, the location of the bins can suggest either a bimodal or trimodal distribution.</p>
<div class="figure">
<span style="display:block;" id="fig:histDiffBins"></span>
<img src="10-graphics2_files/figure-html/histDiffBins-1.png" alt="Histograms with different bin sizes and bin locations of the same normal mixture data set." width="100%"><p class="caption">
Figure 11.13: Histograms with different bin sizes and bin locations of the same normal mixture data set.
</p>
</div>
<p>One possible solution to the bin selection problem for histograms is the Average Shifted Histogram (ASH). First we define a <em><span style="color:#FF9966">density histogram</span></em>. Since we aim to estimate the density (which integrates to one) a density histogram is normalised such that the area in the histogram is equal to one.</p>
<p>Consider a set of bins <span class="math inline">\(B_k=[b_k, b_{(k+1)})\)</span> with fixed bin width <span class="math inline">\(λ=b_{(k+1)}-b_k\)</span> <span class="math inline">\(∀ k\)</span>, then the density histogram is defined as <span class="math inline">\(\hat{f} = \frac{1}{N\lambda} \sum_{i=1}^{N}{I_{[b_k,b_{k+1})}(x_i)}\)</span> for <span class="math inline">\(x∈B_k\)</span>. Consider a collection of <span class="math inline">\(m\)</span> histograms <span class="math inline">\(\hat{f}_1, \hat{f}_2, \dots, \hat{f}_m\)</span> each with bin width <span class="math inline">\(h\)</span>, but with respective bin origins <span class="math inline">\(b_{01}=0, b_{02}=\frac{h}{m}, b_{03}=\frac{2h}{m}, \dots, b_{0m}=\frac{(m-1)h}{m}\)</span>. The <em><span style="color:#FF9966">average shifted histogram</span></em> is defined as <span class="math inline">\(\hat{f}_{ASH} = \frac{1}{m} \sum_{i=1}^{m}{\hat{f}_i}\)</span>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ASH</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">x</span>, <span class="va">b0</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">bk</span> <span class="op">=</span> <span class="fl">15</span>, <span class="va">h</span> <span class="op">=</span> <span class="fl">0.5</span>, <span class="va">m</span> <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="co"># h=lambda</span></span>
<span><span class="op">{</span></span>
<span>  <span class="va">Bvec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/vector.html">as.vector</a></span> <span class="op">(</span><span class="op">(</span><span class="va">bk</span> <span class="op">-</span> <span class="va">b0</span><span class="op">)</span><span class="op">/</span><span class="va">h</span><span class="op">+</span><span class="fl">2</span>, <span class="st">"list"</span><span class="op">)</span></span>
<span>  <span class="va">fhat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span> <span class="op">(</span>nrow <span class="op">=</span> <span class="va">m</span>, ncol <span class="op">=</span> <span class="op">(</span><span class="va">bk</span><span class="op">-</span><span class="va">b0</span><span class="op">)</span><span class="op">/</span><span class="va">h</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> </span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">{</span> <span class="va">Bvec</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span> <span class="op">(</span>from <span class="op">=</span> <span class="va">b0</span><span class="op">+</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">h</span><span class="op">/</span><span class="va">m</span>, to <span class="op">=</span> <span class="va">bk</span><span class="op">+</span><span class="va">h</span><span class="op">+</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">h</span><span class="op">/</span><span class="va">m</span>, by <span class="op">=</span> <span class="va">h</span><span class="op">)</span></span>
<span>      <span class="va">fhat</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span> <span class="op">(</span><span class="va">x</span>, breaks <span class="op">=</span> <span class="va">Bvec</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, right <span class="op">=</span> <span class="cn">T</span>, plot <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">$</span><span class="va">density</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="va">fhat.ASH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">fhat</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span></span>
<span>  <span class="va">x.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span> <span class="op">(</span>from <span class="op">=</span> <span class="va">b0</span>, to <span class="op">=</span> <span class="va">bk</span><span class="op">+</span><span class="va">h</span>,length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">fhat.ASH</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span> <span class="op">(</span><span class="va">x.vec</span>, <span class="va">fhat.ASH</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">ASH</span><span class="op">(</span><span class="va">x</span>, m<span class="op">=</span><span class="fl">20</span>, h<span class="op">=</span><span class="fl">1</span>, b0<span class="op">=</span><span class="op">-</span><span class="fl">2</span>, bk<span class="op">=</span><span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:ASH"></span>
<img src="10-graphics2_files/figure-html/ASH-1.png" alt="Average shifted histogram of normal mixture data." width="100%"><p class="caption">
Figure 11.14: Average shifted histogram of normal mixture data.
</p>
</div>
<p>The ASH is given in Figure <a href="graphics2.html#fig:ASH">11.14</a> A more sophisticated method for estimating a density is with a kernel density estimate. The density histograms is replaced by a smooth kernel function, leading to a smoother estimate. The R function <code><a href="https://rdrr.io/r/stats/density.html">density()</a></code> provides a variety of kernels. Using the default kernel, a Gaussian distribution, the kernel density estimate is given in Figure <a href="graphics2.html#fig:densityExample">11.15</a>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html">density</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"l"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:densityExample"></span>
<img src="10-graphics2_files/figure-html/densityExample-1.png" alt="Guassian kernel density estimate of the normal mixture data." width="100%"><p class="caption">
Figure 11.15: Guassian kernel density estimate of the normal mixture data.
</p>
</div>
<p>Experiment with different kernel function and different choices of bandwidth (argument bw) for controlling the amount of smoothing.</p>
</div>
<div id="a-coplot-with-two-conditioning-variables" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> A coplot with two conditioning variables<a class="anchor" aria-label="anchor" href="#a-coplot-with-two-conditioning-variables"><i class="fas fa-link"></i></a>
</h2>
<p>Consider the <code>state.x77</code> data set. In section <a href="#highLevelPlotting"><strong>??</strong></a> the <code><a href="https://rdrr.io/r/graphics/coplot.html">coplot()</a></code> function was used to construct a plot of <code>Illiteracy</code> and <code>Area</code> conditional on <code>Income</code>. This can be expanded to two conditions, for example plotting <code>Illiteracy</code> and <code>Life expectancy</code> conditional on <code>Income</code> and <code>Area</code>. Interpret. The number of panels and overlap of given intervals can be controlled with the arguments number and overlap.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/coplot.html">coplot</a></span> <span class="op">(</span><span class="va">state.x77</span> <span class="op">[</span>,<span class="st">"Illiteracy"</span><span class="op">]</span> <span class="op">~</span> <span class="va">state.x77</span> <span class="op">[</span>,<span class="st">"Life Exp"</span><span class="op">]</span> <span class="op">|</span> </span>
<span>                                   <span class="va">state.x77</span> <span class="op">[</span>,<span class="st">"Income"</span><span class="op">]</span> <span class="op">+</span> <span class="va">state.x77</span> <span class="op">[</span>,<span class="st">"Area"</span><span class="op">]</span>, </span>
<span>                                number <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span><span class="op">)</span>, overlap<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/condIncomeArea-1.png" width="672"></div>
</div>
<div id="exact-distances-in-graphics" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> Exact distances in graphics<a class="anchor" aria-label="anchor" href="#exact-distances-in-graphics"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li>Obtain a random sample of size 50 from a bivariate normal distribution with <span class="math inline">\(n(50,20)\)</span> marginals and a correlation coefficient of 0.90.</li>
</ol>
<ul>
<li><p>Present the data in the form of a scatterplot.</p></li>
<li>
<p>Next, write an R function to perform the following task on the scatterplot:</p>
<ul>
<li><p>Choose an arbitrary point and label it “A”.</p></li>
<li><p>Draw a line connecting A to a circle with centre exactly 25mm away from A. The diameter of the circle must be exactly 40mm.</p></li>
<li><p>Label the centre point of the circle with a “B”.</p></li>
<li><p>Use a ruler to check the length of the connecting line and diameter of the circle.</p></li>
</ul>
</li>
<li><p>Obtain a print copy of the graph and check the lengths again.<em>Hint</em>: Study the help file of function <code><a href="https://rdrr.io/r/graphics/par.html">par()</a></code>.</p></li>
</ul>
<ol start="2" style="list-style-type: lower-alpha">
<li>Use R to make a ruler calibrated in centimetres from zero to 15 cms.</li>
</ol>
</div>
<div id="multiple-graphics-windows-in-r" class="section level2" number="11.9">
<h2>
<span class="header-section-number">11.9</span> Multiple graphics windows in R<a class="anchor" aria-label="anchor" href="#multiple-graphics-windows-in-r"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: lower-alpha">
<li>Study how the following instructions work to control multiple graphics windows in R:</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.new</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.list</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.set</a></span><span class="op">(</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.next</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.cur</a></span><span class="op">(</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev2.html">dev.copy</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.prev</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">dev.off</a></span><span class="op">(</span><span class="op">)</span>   </span>
<span><span class="fu">dev.ask</span><span class="op">(</span><span class="op">)</span>   </span>
<span><span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html">graphics.off</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Study the information that R gives via the execution of <code>help.search ("graph")</code>.</li>
</ol>
</div>
<div id="more-complex-layouts" class="section level2" number="11.10">
<h2>
<span class="header-section-number">11.10</span> More complex layouts<a class="anchor" aria-label="anchor" href="#more-complex-layouts"><i class="fas fa-link"></i></a>
</h2>
<p>Study the graphical requirements needed for constructing Figure <a href="graphics2.html#fig:complexLayout">11.16</a> and how to code these requirements.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.func</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="op">)</span> </span>
<span><span class="op">{</span> <span class="va">old.state</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>no.readonly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html">on.exit</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span><span class="va">old.state</span><span class="op">)</span><span class="op">)</span></span>
<span>   </span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.66</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html">ts.plot</a></span> <span class="op">(</span><span class="va">mdeaths</span>, xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Male deaths"</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.plot.html">ts.plot</a></span> <span class="op">(</span><span class="va">fdeaths</span>, xlab <span class="op">=</span> <span class="st">"Year"</span>, ylab <span class="op">=</span> <span class="st">"Female deaths"</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.66</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mfg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, new<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span> <span class="op">(</span><span class="va">mdeaths</span>, xlab <span class="op">=</span> <span class="st">"Male deaths"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span> <span class="op">(</span><span class="va">fdeaths</span>, xlab <span class="op">=</span> <span class="st">"Female deaths"</span>, ylab <span class="op">=</span> <span class="st">"Frequency"</span>, main<span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span> <span class="op">(</span>omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span> <span class="op">(</span><span class="st">"Line plot and Histogram for male deaths"</span><span class="op">)</span></span>
<span>   </span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>omd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, mfcol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/graphics/title.html">title</a></span> <span class="op">(</span><span class="st">"Line plot and Histogram for female deaths"</span><span class="op">)</span>          </span>
<span><span class="op">}</span></span>
<span><span class="fu">my.func</span> <span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:complexLayout"></span>
<img src="10-graphics2_files/figure-html/complexLayout-1.png" alt="A complex graphics layout." width="100%"><p class="caption">
Figure 11.16: A complex graphics layout.
</p>
</div>
</div>
<div id="dynamic-3d-graphics-in-r" class="section level2" number="11.11">
<h2>
<span class="header-section-number">11.11</span> Dynamic 3D graphics in R<a class="anchor" aria-label="anchor" href="#dynamic-3d-graphics-in-r"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Study the R package <code>rgl</code>.</p></li>
<li><p>Attach library <code>rgl</code> to the search path and then issue the R command <code>example (plot3d)</code>. Use the mouse buttons to rotate and zoom the rgl graph.</p></li>
<li><p>Next, issue the R command <code>example (surface3d)</code> and interactively explore the 3D figure.</p></li>
</ul>
</div>
<div id="animation" class="section level2" number="11.12">
<h2>
<span class="header-section-number">11.12</span> Animation<a class="anchor" aria-label="anchor" href="#animation"><i class="fas fa-link"></i></a>
</h2>
<p>Study the following two functions in detail:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anim1</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sleep</span> <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> </span>
<span> <span class="op">{</span> <span class="co"># Press ESC to end animation</span></span>
<span>   <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span>   <span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span> <span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span><span class="op">*</span><span class="va">pi</span>, length <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span>
<span>   <span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>   <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span>   <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span></span>
<span>   <span class="op">{</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span> <span class="op">(</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, pch <span class="op">=</span> <span class="fl">16</span>, cex <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">)</span> </span>
<span>      <span class="co">#Sys.sleep() suspends execution for a given number of seconds</span></span>
<span>    <span class="op">}</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Recall.html">Recall</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">)</span> </span>
<span> <span class="op">}</span></span>
<span></span>
<span><span class="va">anim2</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">sleep</span> <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span> </span>
<span><span class="op">{</span> <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span> <span class="op">(</span>from <span class="op">=</span> <span class="fl">1</span>, to <span class="op">=</span> <span class="fl">3</span>, by <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">{</span>  <span class="fu"><a href="https://rdrr.io/r/graphics/frame.html">plot.new</a></span> <span class="op">(</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/plot.window.html">plot.window</a></span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span> <span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">16</span><span class="op">)</span>, asp <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html">arrows</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">i</span>, <span class="fl">2</span><span class="op">*</span><span class="va">i</span>, <span class="fl">4</span><span class="op">*</span><span class="va">i</span>, <span class="fl">4</span><span class="op">*</span><span class="va">i</span><span class="op">)</span></span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Recall.html">Recall</a></span><span class="op">(</span><span class="va">sleep</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Write an R function to show a wheel with two spokes moving forward with adjustable speed.</p>
</div>
<div id="Ex10" class="section level2" number="11.13">
<h2>
<span class="header-section-number">11.13</span> Exercise<a class="anchor" aria-label="anchor" href="#Ex10"><i class="fas fa-link"></i></a>
</h2>
<div style="color: #80CC99;">
<ol style="list-style-type: decimal">
<li>In many real life situations it is necessary to identify an object when only limited information is available. The following problem how such a problem can be empirically investigated.</li>
</ol>
<div style="margin-left: 25px; margin-right: 20px;">
<p>The function <code><a href="https://rdrr.io/r/graphics/persp.html">persp()</a></code> used for constructing Figure <a href="graphics2.html#fig:persp">11.12</a> requires a regular pattern of <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> coordinates. If such a pattern is not available it is necessary to interpolate e.g. with <code>interp()</code> (available in package <code>akima</code>) using the available values.</p>
<p>Use the function <code><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid()</a></code> to create a grid of regularly spaced <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> values and evaluate the “sombrero” function of Figure <a href="graphics2.html#fig:persp">11.12</a> at each of these points.</p>
<p>Now use <code><a href="https://rdrr.io/r/base/sample.html">sample()</a></code> to randomly sample points from that grid and then the <code>interp()</code> function to interpolate the values of z throughout the grid.</p>
<p>Finally, use <code><a href="https://rdrr.io/r/graphics/persp.html">persp()</a></code> to construct a plot of the interpolated values.</p>
<p>What fraction of data is needed in the sample to get a good representation of the true shape of the data. <em>Hint</em>: since <code><a href="https://rdrr.io/r/graphics/persp.html">persp()</a></code> does not accept <code>NA</code>s replace <code>NA</code>s with the minimum of the non-missing z values.</p>
</div>
<ol start="2" style="list-style-type: decimal">
<li><p>Use <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> and write a function to allow placing a legend with a pointing device anywhere on an existing plot.</p></li>
<li><p>Use the <code>state.x77</code> data set to construct a scatterplot of <code>Illiteracy</code> as a function of <code>Income</code>. Now construct a second scatterplot of the same data but with the origin on the right-hand side of the x-axis. In order to complete this task it is necessary that the values on the x-axis increase from the left-hand side to the right-hand side.</p></li>
<li><p>Consider the following data</p></li>
</ol>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th></th>
<th>Test 1</th>
<th>Test 2</th>
<th>Test 3</th>
<th>Test 4</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Group A:</td>
<td>10</td>
<td>15</td>
<td>30</td>
<td>12</td>
</tr>
<tr class="even">
<td>Group B:</td>
<td>125</td>
<td>130</td>
<td>148</td>
<td>115</td>
</tr>
</tbody>
</table></div>
<div style="margin-left: 25px; margin-right: 20px;">
<p>Plot the data of the two groups in the form of two profiles on the same set of axes.<br>
Plot the data against Test 1, Test 2, Test 3 and Test 4 on the x-axis.
The scale of the data of Group A must appear on the y-axis on the left-hand side and that of Group B on the y-axis on the right-hand side. A detailed legend must be provided.</p>
</div>
</div>
</div>
<div id="the-package-ggplot2" class="section level2" number="11.14">
<h2>
<span class="header-section-number">11.14</span> The package ggplot2<a class="anchor" aria-label="anchor" href="#the-package-ggplot2"><i class="fas fa-link"></i></a>
</h2>
<p>The package <code>ggplot2</code> is based on the ideas of <span class="citation">Wickham (<a href="references.html#ref-Wickham2010">2010</a>)</span> as described in the paper “A layered grammar of graphics” and makes use of the The Grammar of Graphics by <span class="citation">Wilkenson (<a href="references.html#ref-Wilkenson2005">2005</a>)</span>.</p>
<div class="figure">
<span style="display:block;" id="fig:ggplotStructure"></span>
<img src="pics/ggplot.jpg" alt="Layer structure of ggplot2 package." width="100%"><p class="caption">
Figure 11.17: Layer structure of ggplot2 package.
</p>
</div>
<p>In Figure <a href="graphics2.html#fig:ggplotStructure">11.17</a>(a) the components of a <em><span style="color:#FF9966">layer</span></em> is depicted. The first essential component is the <em><span style="color:#FF9966">data</span></em> to be represented in the graphic. Together with the data, there needs to be an <em><span style="color:#FF9966">aesthetic mapping</span></em>, describing which variable is mapped to the x-direction, y-direction, the size, shape, colour, etc. The <em><span style="color:#FF9966">statistics</span></em> component optionally transforms the data to quantities that needs to be plotted. Typically, the transformation is used to summarise the data. It is possible to map aesthetics to these new variables. The <em><span style="color:#FF9966">geometry</span></em> defines how each aesthetic is displayed, as points, lines, boxplots, densities, histograms, etc. Each geometry can only display specific aesthetics, for example a point has position, colour, shape and size. Position adjustment is needed in cases where geometric elements overlap, for example using jitter in scatterplots or placing multiple bars stacked or side-by-side in a barplot.</p>
<p>A graphic can consist of several layers, as shown in Figure <a href="graphics2.html#fig:ggplotStructure">11.17</a>(b). According to the grammar of graphics, a <em><span style="color:#FF9966">scales</span></em> component needs to be specified. The scales are common across layers and describe the mapping of the data to aesthetic attributes such as which colour is associated with which level of a categorical variable. One scale is needed for each aesthetic property used in the layers. In order to place the geometric objects on the plotting plane, a scale is needed. The most commonly used scale is the Cartesian axes, while others such as polar coordinates is also available.</p>
<p><em><span style="color:#FF9966">Faceting</span></em> splits the data into small multiples of different subsets of the data set. With this component we identify the variable(s) for splitting and how the splitting should be arranged. <em><span style="color:#FF9966">Themes</span></em> are not linked to the data but provide instructions on aspects such as titles, labels, fonts, background, gridlines, and legends.</p>
<p>The full specification of all the components in a ggplot, can be very cumbersome. Defaults are specified, for instance for each geometry there is a default statistic and for each statistic a default geometry. We can therefore build our plot stepwise, fine-tuning detailed aspects until the required graphic is obtained.</p>
<p>We will start with some simple plots and then build more complicated graphics. We will use the <code>cereal</code> tibble created from the <code>UScereal</code> data in package <code>MASS</code> (see section <a href="data.html#dplyr">10.10.4</a>) for illustration.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; ── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──</span></span>
<span><span class="co">#&gt; ✔ dplyr     1.1.4     ✔ readr     2.1.5</span></span>
<span><span class="co">#&gt; ✔ forcats   1.0.0     ✔ stringr   1.5.1</span></span>
<span><span class="co">#&gt; ✔ ggplot2   3.5.2     ✔ tibble    3.3.0</span></span>
<span><span class="co">#&gt; ✔ lubridate 1.9.4     ✔ tidyr     1.3.1</span></span>
<span><span class="co">#&gt; ✔ purrr     1.1.0     </span></span>
<span><span class="co">#&gt; ── Conflicts ────────────────────── tidyverse_conflicts() ──</span></span>
<span><span class="co">#&gt; ✖ dplyr::filter() masks stats::filter()</span></span>
<span><span class="co">#&gt; ✖ dplyr::lag()    masks stats::lag()</span></span>
<span><span class="co">#&gt; ✖ dplyr::select() masks MASS::select()</span></span>
<span><span class="co">#&gt; ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</span></span>
<span><span class="va">cereal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span> <span class="op">(</span><span class="va">UScereal</span><span class="op">)</span></span></code></pre></div>
<div id="barplot" class="section level3" number="11.14.1">
<h3>
<span class="header-section-number">11.14.1</span> Barplot<a class="anchor" aria-label="anchor" href="#barplot"><i class="fas fa-link"></i></a>
</h3>
<p>The command</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mfr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBarplot-1.png" width="672"></div>
<p>produces a simple barplot of the <code>cereal</code> data with <code>mfr</code> on the x-axis and counts of each level in the <code>bars</code>. No position adjustments are made, while the default colour for the bars is used to plot the complete data set on Cartesian axes with the default theme.</p>
<p>We can change the colour of the bars with the command</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mfr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gold"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBarplot2-1.png" width="672"></div>
<p>Now we add an aesthetic for the bars to be coloured according to the vitamin enrichment, while at the same time, changing the orientation. Note that in the previous example, the fill colour was specified outside of the function <code><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes()</a></code>, while here, it is specified as an aesthetic.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mfr</span>, fill <span class="op">=</span> <span class="va">vitamins</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBarplot3-1.png" width="672"></div>
<p>The default is to stack the bars. In order to position the bars side-by-side we use the function <code><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge()</a></code>.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mfr</span>, fill <span class="op">=</span> <span class="va">vitamins</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBatplot4-1.png" width="672"></div>
</div>
<div id="scatterplot" class="section level3" number="11.14.2">
<h3>
<span class="header-section-number">11.14.2</span> Scatterplot<a class="anchor" aria-label="anchor" href="#scatterplot"><i class="fas fa-link"></i></a>
</h3>
<p>The simplest call to produce a scatterplot uses the identity statistical transformation with no position adjustment on the complete data set with default size, shape and colour of the plotting characters.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>        </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter-1.png" width="672"></div>
<p>The point colours can be specified either according to a categorical variable, or a spectra based on a continuous variable.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shelf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter2-1.png" width="672"></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter2-2.png" width="672"></div>
<p>A scatterplot smoother can be added to our plot with the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth()</a></code>.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using method = 'loess' and formula = 'y ~</span></span>
<span><span class="co">#&gt; x'</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter3-1.png" width="672"></div>
<p>The smooth function can also be a linear regression line.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter4-1.png" width="672"></div>
<p>To add different sizes and shapes according to <code>shelf</code> and <code>mfr</code>, respectively, we need the command</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span>, </span>
<span>                                shape <span class="op">=</span> <span class="va">mfr</span>, </span>
<span>                                size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shelf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using size for a discrete variable is not advised.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter5-1.png" width="672"></div>
<p>Finally, since there are multiple observations with zero fat, we want to jitter the observations in the vertical direction with a random amount in the interval <span class="math inline">\(±0.05\)</span>.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span>,</span>
<span>                              shape <span class="op">=</span> <span class="st">"cross"</span>,</span>
<span>                              position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitter.html">position_jitter</a></span><span class="op">(</span>height<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter6-1.png" width="672"></div>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label()</a></code> functions are useful to replace plotting characters with sample names or a specified label.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter7-1.png" width="672"></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">mfr</span><span class="op">)</span>, check_overlap<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter7-2.png" width="672"></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScatter7-3.png" width="672"></div>
</div>
<div id="dotplot" class="section level3" number="11.14.3">
<h3>
<span class="header-section-number">11.14.3</span> Dotplot<a class="anchor" aria-label="anchor" href="#dotplot"><i class="fas fa-link"></i></a>
</h3>
<p>Below a simple dotplot of the carbo variable followed by another dotplot with several tweaks in presentation.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carbo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Bin width defaults to 1/30 of the range of the data. Pick</span></span>
<span><span class="co">#&gt; better value with `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotDot-1.png" width="672"></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">carbo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_dotplot.html">geom_dotplot</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">2</span>, stackdir <span class="op">=</span> <span class="st">"center"</span>, </span>
<span>                     stackratio <span class="op">=</span> <span class="fl">0.8</span>, dotsize <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span>  </span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotDot-2.png" width="672"></div>
</div>
<div id="boxplot" class="section level3" number="11.14.4">
<h3>
<span class="header-section-number">11.14.4</span> Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"><i class="fas fa-link"></i></a>
</h3>
<p>The <code><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot()</a></code> function allows us to make a simple boxplot. However, below we make several boxplots according to vitamin enrichment and overlay the observed data.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>        mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vitamins</span>, y <span class="op">=</span> <span class="va">sodium</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBoxplot-1.png" width="672"></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>        mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vitamins</span>, y <span class="op">=</span> <span class="va">sodium</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotBoxplot-2.png" width="672"></div>
</div>
<div id="line-plot" class="section level3" number="11.14.5">
<h3>
<span class="header-section-number">11.14.5</span> Line plot<a class="anchor" aria-label="anchor" href="#line-plot"><i class="fas fa-link"></i></a>
</h3>
<p>To illustrate plotting lines with <code>ggplot2</code> we will create a small data set <span class="math inline">\(y_a=log(x)\)</span>⁡ and <span class="math inline">\(y_b=2log(x)\)</span> with <span class="math inline">\(0 &lt; x&lt; 1\)</span>.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0.01</span>, to <span class="op">=</span> <span class="fl">0.99</span>, len <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>   </span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">2</span><span class="op">)</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span> </span>
<span><span class="va">dat</span></span>
<span><span class="co">#&gt; # A tibble: 200 × 3</span></span>
<span><span class="co">#&gt;         x     y z    </span></span>
<span><span class="co">#&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></span>
<span><span class="co">#&gt;  1 0.01   -4.61 a    </span></span>
<span><span class="co">#&gt;  2 0.0199 -3.92 a    </span></span>
<span><span class="co">#&gt;  3 0.0298 -3.51 a    </span></span>
<span><span class="co">#&gt;  4 0.0397 -3.23 a    </span></span>
<span><span class="co">#&gt;  5 0.0496 -3.00 a    </span></span>
<span><span class="co">#&gt;  6 0.0595 -2.82 a    </span></span>
<span><span class="co">#&gt;  7 0.0694 -2.67 a    </span></span>
<span><span class="co">#&gt;  8 0.0793 -2.53 a    </span></span>
<span><span class="co">#&gt;  9 0.0892 -2.42 a    </span></span>
<span><span class="co">#&gt; 10 0.0991 -2.31 a    </span></span>
<span><span class="co">#&gt; # ℹ 190 more rows</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotLine-1.png" width="672"></div>
</div>
<div id="density-estimates" class="section level3" number="11.14.6">
<h3>
<span class="header-section-number">11.14.6</span> Density estimates<a class="anchor" aria-label="anchor" href="#density-estimates"><i class="fas fa-link"></i></a>
</h3>
<p>Non-parametric density estimates are useful to summarise the distribution of data. For a single variable, the <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html">geom_density()</a></code> function produces a density estimate (see section <a href="graphics2.html#density">11.6</a>). Here we illustrate the use of the two-dimensional density estimate with the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html">geom_density_2d()</a></code> and the Old Faithful data from package <code>datasets</code>. Note that the call to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> is written to the object <code>p1</code>. The content of <code>p1</code> is the plot. Assigning the name <code>p1</code> to the plot prevents having to retype the full call for every subsequent execution.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">faithful</span>, </span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eruptions</span>, y <span class="op">=</span> <span class="va">waiting</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">5</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">110</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values or values outside</span></span>
<span><span class="co">#&gt; the scale range (`geom_point()`).</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotDensity-1.png" width="672"></div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p1</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html">geom_density_2d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing non-finite outside the scale</span></span>
<span><span class="co">#&gt; range (`stat_density2d()`).</span></span>
<span><span class="co">#&gt; Removed 3 rows containing missing values or values outside</span></span>
<span><span class="co">#&gt; the scale range (`geom_point()`).</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotDensity-2.png" width="672"></div>
<p>In the above examples, the geometry is specified, without any specification of statistical transformations. Although not specified explicitly, statistical transformations are performed. For instance in the barplot above, the <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">stat_count()</a></code> is the default for <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> to determine the frequencies plotted on the vertical axis. In most instances, the default <code>stat_xxx()</code> function is appropriate for the particular <code>geom_yyy()</code> function and specifying other statistical transformations could lead to non-sensicle calls. In most calls to <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, the default <code>stat_xxx()</code> is appropriate and not explicitly specified. Below, we look at a few exceptions.</p>
</div>
<div id="empirical-cumulative-distribution-function" class="section level3" number="11.14.7">
<h3>
<span class="header-section-number">11.14.7</span> Empirical cumulative distribution function<a class="anchor" aria-label="anchor" href="#empirical-cumulative-distribution-function"><i class="fas fa-link"></i></a>
</h3>
<p>The empirical cumulative distribution function also provide details on the shape of the distribution underlying the observations and can be plotted with <code><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf()</a></code>.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n.1.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">F.4.9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">rf</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">4</span>,<span class="fl">9</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">n.1.1</span>,<span class="va">F.4.9</span><span class="op">)</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="va">dat</span>, cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">n.1.1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotEcdf-1.png" width="672"></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">dat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">value</span>, colour <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotEcdf-2.png" width="672"></div>
</div>
<div id="mathematical-functions" class="section level3" number="11.14.8">
<h3>
<span class="header-section-number">11.14.8</span> Mathematical functions<a class="anchor" aria-label="anchor" href="#mathematical-functions"><i class="fas fa-link"></i></a>
</h3>
<p>Any function <span class="math inline">\(f(x)\)</span> can be plotted, or added to a plot with <code><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">stat_function()</a></code>. First we will plot the function <span class="math inline">\(f(x)=2e^xcos⁡(x)\)</span>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">cos</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotfx-1.png" width="672"></div>
<p>Next we will compare our empirical cumulative distribution function, to the cumulative distribution functions of a Poisson and normal distribution. (Remember, the normal distribution provides an approximation to the Poisson).</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">dat3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">dat3</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_ecdf.html">stat_ecdf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">ppois</span>,    </span>
<span>                args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>lambda<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">pnorm</span>, </span>
<span>               args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>mean<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>               col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/gglotfx2-1.png" width="672"></div>
</div>
<div id="after_stat-function" class="section level3" number="11.14.9">
<h3>
<span class="header-section-number">11.14.9</span> <code>after_stat()</code> function<a class="anchor" aria-label="anchor" href="#after_stat-function"><i class="fas fa-link"></i></a>
</h3>
<p>When constructing a histogram, the frequencies appear on the vertical axis. These frequencies are the output of the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">stat_bin()</a></code> which means they are not available up front in the data set itself. The <code><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat()</a></code> function allows us to use the computed variables, for instance to scale the histogram to area <span class="math inline">\(=1\)</span> in order to compare the observed distribution to a theoretical probability density function.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html">rgamma</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dat4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">dat4</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotAfterstat-1.png" width="672"></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>  </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">dat4</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                      fill<span class="op">=</span><span class="st">"pink"</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html">geom_function</a></span> <span class="op">(</span>fun <span class="op">=</span> <span class="va">dgamma</span>, </span>
<span>                      args<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">5</span>, rate <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; `stat_bin()` using `bins = 30`. Pick better value with</span></span>
<span><span class="co">#&gt; `binwidth`.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotAfterstat-2.png" width="672"></div>
</div>
<div id="scales" class="section level3" number="11.14.10">
<h3>
<span class="header-section-number">11.14.10</span> Scales<a class="anchor" aria-label="anchor" href="#scales"><i class="fas fa-link"></i></a>
</h3>
<p>The scales link the aesthetic attributes such as colours, plotting characters, line types, axis scales etc. to the data. Implicitly, in all the calls above, default scales are specified. Should we wish to change the defaults, the scales need to be specified explicitly.</p>
<p>In the call</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales-1.png" width="672"></div>
<p>different colours are assigned to the points, based on the content of <code>mfr</code>. Since <code>mfr</code> is a categorical variable with six levels, the first six default colours are used. The user can specify their own colour selection with the function <code><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual()</a></code>. However, the Brewer palettes are convenient colour schemes designed by Cynthia Brewer as described at
<a href="http://colorbrewer2.org" class="uri">http://colorbrewer2.org</a>. Below a qualitative scale is used according to the levels of <code>mfr</code>.</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">mfr</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_colour_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales2-1.png" width="672"></div>
<p>Next, we will define our own gradient fill scaling for use with the continuous variable <code>sugars</code>. The default scale ranges from light blue to dark blue.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales3-1.png" width="672"></div>
<p>The built in colour palettes <code>hcl.colors</code>, <code>hcl.pals</code>, <code>rainbow</code>, <code>heat.colors</code>, <code>terrain.colors</code>, <code>topo.colors</code> and <code>cm.colors</code> can be selected with the function <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradientn()</a></code> or <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn()</a></code>.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradientn</a></span><span class="op">(</span>colours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span><span class="op">(</span><span class="fl">21</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales4-1.png" width="672"></div>
<p>The functions <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient()</a></code> allows the user to specify a two-colour gradient scale while <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient2()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2()</a></code> allows for specification of a three-colour gradient scale.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>                             high <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales5-1.png" width="672"></div>
<p>In a final example of scales we will change the vertical axis to a log scale while changing the axis markers on the horizontal scale.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_colour_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>                             high <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">50</span>, to <span class="op">=</span> <span class="fl">450</span>, by <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>trans <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in scale_y_continuous(trans = "log"): log-2.718282</span></span>
<span><span class="co">#&gt; transformation introduced infinite values.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotScales6-1.png" width="672"></div>
</div>
<div id="coordinates" class="section level3" number="11.14.11">
<h3>
<span class="header-section-number">11.14.11</span> Coordinates<a class="anchor" aria-label="anchor" href="#coordinates"><i class="fas fa-link"></i></a>
</h3>
<p>By default, all the plots we have made are on the Cartesian axes. One alternative would be to use a polar coordinate system.</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Hadley's favourite pie chart</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"does not resemble"</span>, <span class="st">"resembles"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">variable</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span><span class="st">"y"</span>, start <span class="op">=</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Pac man"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotCoords-1.png" width="672"></div>
<p>To plot the function <span class="math inline">\(f(\theta)=\theta sin(\theta)\)</span>, <span class="math inline">\(0 \le \theta \le \frac{\pi}{2}\)</span> we need to following code:</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">2</span>, len <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">my.dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span> <span class="op">(</span>theta <span class="op">=</span> <span class="va">theta.vec</span>,</span>
<span>                  r <span class="op">=</span> <span class="va">theta.vec</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="va">theta.vec</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">my.dat</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">theta</span>, y<span class="op">=</span><span class="va">r</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html">coord_polar</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotCoords2-1.png" width="672"></div>
<p>As illustrated in Exercise <a href="#Ex6"><strong>??</strong></a> number 10 it is sometimes essential to keep the aspect ratio in the graphic fixed, usually at <span class="math inline">\(1:1\)</span>. Classical scaling is a method to produce a map from a given matrix of pairwise distances. In the code below, a map (subject to rotation and reflection) of cities in Europe is produce with the function <code><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale()</a></code>. In order to visually assess intercity distances, it is important to have one unit in the horizontal direction equal to one unit in the vertical direction. This is achieved with <code>coord_fixed (ratio = 1)</code>.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">city.coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>city<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">eurodist</span>,<span class="st">"Labels"</span><span class="op">)</span>,</span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/cmdscale.html">cmdscale</a></span><span class="op">(</span><span class="va">eurodist</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">city.coords</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"dim"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span><span class="va">city.coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">city.coords</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span> <span class="op">(</span><span class="va">city.coords</span>, mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dim1</span>, y <span class="op">=</span> <span class="va">dim2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label<span class="op">=</span><span class="va">city</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>         </span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotCoords3-1.png" width="672"></div>
</div>
<div id="facets" class="section level3" number="11.14.12">
<h3>
<span class="header-section-number">11.14.12</span> Facets<a class="anchor" aria-label="anchor" href="#facets"><i class="fas fa-link"></i></a>
</h3>
<p>Facets allows for the grouping of the data set into smaller similar data sets. We can plot the <code>fat</code> vs <code>calories</code> for every manufacturer separately.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotFacets-1.png" width="672"></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotFacets-2.png" width="672"></div>
<p>Although it does not allow for comparison across plots, each plot can have its own axis range while splitting the data according to two variables.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>       mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span> <span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">mfr</span>, <span class="va">vitamins</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotFacets2-1.png" width="672"></div>
</div>
<div id="themes" class="section level3" number="11.14.13">
<h3>
<span class="header-section-number">11.14.13</span> Themes<a class="anchor" aria-label="anchor" href="#themes"><i class="fas fa-link"></i></a>
</h3>
<p>As mentioned before, themes is disconnected with the data. Themes allow for the formatting of the background, gridlines, titles, etc.</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>      mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">mfr</span>, fill <span class="op">=</span> <span class="va">vitamins</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">mfr</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p3</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-1.png" width="672"></div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-2.png" width="672"></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-3.png" width="672"></div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span><span class="op">(</span><span class="st">"gray"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_line()` is deprecated as of</span></span>
<span><span class="co">#&gt; ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; ℹ Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; This warning is displayed once every 8 hours.</span></span>
<span><span class="co">#&gt; Call `lifecycle::last_lifecycle_warnings()` to see where</span></span>
<span><span class="co">#&gt; this warning was generated.</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-4.png" width="672"></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">18</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-5.png" width="672"></div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p3</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Heading"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-6.png" width="672"></div>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cereal</span>, </span>
<span>             mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">calories</span>, y <span class="op">=</span> <span class="va">fat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="va">sugars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_colourbar.html">guide_colourbar</a></span><span class="op">(</span>barwidth <span class="op">=</span> <span class="fl">0.25</span>, barheight <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                                        nbin<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-7.png" width="672"></div>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span> <span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>ncol<span class="op">=</span><span class="fl">2</span>, reverse<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-8.png" width="672"></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p4</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">50</span>, to <span class="op">=</span> <span class="fl">450</span>, by <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>,</span>
<span>                        guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html">guide_axis</a></span><span class="op">(</span>n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html">guide_axis</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>, y.sec <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html">guide_axis</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotThemes-9.png" width="672"></div>
</div>
</div>
<div id="exercise-11" class="section level2" number="11.15">
<h2>
<span class="header-section-number">11.15</span> Exercise<a class="anchor" aria-label="anchor" href="#exercise-11"><i class="fas fa-link"></i></a>
</h2>
<div style="color: #80CC99;">
<p>1 (a) Convert the <code>state.region</code> and <code>state.x77</code> data into a dataframe <code>USA.states</code> and construct a histogram of the population. Set the bin widths at 2000 (thousands).</p>
<div style="margin-left: 25px; margin-right: 20px;">
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Make a boxplot of the <code>Income</code> for each region separately.</p></li>
<li><p>A violin plot is based on a boxplot but also show the probability density of the data at different values, usually smoothed by a kernel density estimator. Make violin plots of the <code>Income</code> for each region separately and assign a custom scale to the violin fill values.</p></li>
</ol>
</div>
<ol start="2" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Set the seed to 7453 and generate a matrix of 100 values from a <span class="math inline">\(n(10,2^2)\)</span> distribution arranged in two columns of 50 values each. Construct a data frame with numeric variables <code>val1</code> and <code>val2</code> containing the coordinates of a convex hull around the data in your matrix by using the function <code><a href="https://rdrr.io/r/grDevices/chull.html">chull()</a></code>. Now make a plot of the data and add the convex hull with the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon()</a></code>. The convex hull should be in red with no fill. Note that you will need two dataframes or tibbles, one for the data points in the matrix and another for the convex hull.</li>
</ol></li>
</ol>
<div style="margin-left: 25px; margin-right: 20px;">
<ol start="2" style="list-style-type: lower-alpha">
<li>Study the code below for the construction of rectangles on a graphic.</li>
</ol>
</div>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                 y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>                 z <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, width <span class="op">=</span> <span class="va">w</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">x</span> <span class="op">-</span> <span class="va">w</span> <span class="op">/</span> <span class="fl">2</span>, </span>
<span>               xmax <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">w</span> <span class="op">/</span> <span class="fl">2</span>, </span>
<span>               ymin <span class="op">=</span> <span class="va">y</span>, ymax <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">z</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>Use the <code>USA.states</code> data from (1) and construct a density plot of the <code>Frost</code> variable. Set the bandwidth <code>bw = 10</code> to determine the amount of smoothing.</li>
</ol></li>
</ol>
<div style="margin-left: 25px; margin-right: 20px;">
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Next, construct four density plots on the same set of axes for the four regions, using different colours for each.</p></li>
<li><p>Now, make four separate plots by using the function <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap()</a></code>. Change the line type to type 3 and a line width of 1.5.</p></li>
<li><p>Set the random seed to 8359 and generate a vector of length 500 of random values from a <span class="math inline">\(n(-1,0.04)\)</span> distribution. Construct a density plot, with x-axis range (i) in reverse by using function <code><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_reverse()</a></code> and (ii) from 0 on the left and -2 on the right by using function <code><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim()</a></code>.</p></li>
</ol>
</div>
<ol start="4" style="list-style-type: decimal">
<li><ol style="list-style-type: lower-alpha">
<li>The data set <code>fujitopo</code> in the package <code>geomapdata</code> contains a list with three components: <code>lat</code> (latitude), <code>lon</code> (longitude) and <code>z</code> (elevation). Construct a tibble with three columns <code>lat</code>, <code>lon</code> and <code>z</code> and then use the function <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html">geom_contour()</a></code> to construct a contour plot. Since it is a topographic map, ensure that you have an aspect ratio of 1.</li>
</ol></li>
</ol>
<div style="margin-left: 25px; margin-right: 20px;">
<ol start="2" style="list-style-type: lower-alpha">
<li>
<p>Repeat exercise <a href="graphics2.html#Ex10">11.13</a> number 1 using the <code><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_raster()</a></code> function and making contour plots instead of 3D plots.</p>
<ul>
<li>First make a contour plot of the full data set.</li>
<li>Select a sample of size 500 and make a contour plot.</li>
<li>Repeat the above with <code>geom_raster ( , interpolate = TRUE)</code>.</li>
</ul>
</li>
</ol>
</div>
<ol start="5" style="list-style-type: decimal">
<li>The maps package can be used to draw a world map or a map of a specific country or region. The <code>ggplot2</code> function <code><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data()</a></code> converts the data from the maps package in to a data frame suitable for plotting with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Study the maps constructed below and comment on the different “projections”.</li>
</ol>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">USArrests</span><span class="op">)</span><span class="op">)</span>, <span class="va">USArrests</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span> <span class="op">(</span><span class="va"><a href="https://github.com/adeckmyn/maps">maps</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'maps'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:purrr':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     map</span></span>
<span><span class="va">states_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html">map_data</a></span><span class="op">(</span><span class="st">"state"</span><span class="op">)</span></span>
<span><span class="va">pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">crimes</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>map_id <span class="op">=</span> <span class="va">state</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_map.html">geom_map</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Murder</span><span class="op">)</span>, map <span class="op">=</span> <span class="va">states_map</span><span class="op">)</span> <span class="op">+</span></span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">states_map</span><span class="op">$</span><span class="va">long</span>, </span>
<span>                           y <span class="op">=</span> <span class="va">states_map</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span> </span>
<span><span class="va">pp</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-1.png" width="672"></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"azequalarea"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-2.png" width="672"></div>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pp</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"orthographic"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-3.png" width="672"></div>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">usamap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">states_map</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">long</span>, <span class="va">lat</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">usamap</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-4.png" width="672"></div>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usamap</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-5.png" width="672"></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usamap</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"azequalarea"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-6.png" width="672"></div>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usamap</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"orthographic"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-7.png" width="672"></div>
<div class="sourceCode" id="cb82"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">usamap</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html">coord_map</a></span><span class="op">(</span><span class="st">"orthographic"</span>, orientation <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">0</span>, <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="10-graphics2_files/figure-html/ggplotMaps-8.png" width="672"></div>
<ol start="6" style="list-style-type: decimal">
<li><p>Reproduce the plot created in section <a href="graphics2.html#multipleLines">11.4.2</a> with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p></li>
<li><p>Reproduce the plot created in section <a href="graphics2.html#Legends">11.4.3</a> with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p></li>
<li><p>Reproduce the left panel of the plot in Figure <a href="graphics2.html#fig:catAxis">11.10</a> with <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>.</p></li>
</ol>
</div>

</div>
</div>
  <div class="chapter-nav">
<div class="empty"></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction into R Applications and Programming: A Tutorial</strong>" was written by Niël J le Roux and Sugnet Lubbe. It was last built on 2025.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
